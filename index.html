<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Mermaid Diagram</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.3.0/mermaid.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        #diagram-container {
            width: 100%;
            height: 100%;
            background-color: #f0f0f0;
            position: relative;
            overflow: hidden;
        }
        #diagram {
            position: absolute;
            transform-origin: 0 0;
        }
        #header {
            position: fixed;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 1000;
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="header">Diagram</div>
    <div id="diagram-container">
        <div id="diagram"></div>
    </div>

    <script>
        mermaid.initialize({ startOnLoad: false });

        const diagramContainer = document.getElementById('diagram-container');
        const diagram = document.getElementById('diagram');
        let isDragging = false;
        let startX, startY, diagramX = 0, diagramY = 0;
        let scale = 1;

        const diagramDefinition = `
        graph TD
            A[Abiel's Journey to Becoming a Doctor] --> B[Develop Interest in Medicine]
            B --> C[Explore Neuroscience]
            C --> D{Is Neuroscience Right?}
            D -->|Yes| E[Deepen Neuroscience Knowledge]
            D -->|No| F[Explore Other Fields]
            E --> G[Gain Experience]
            F --> G
            G --> H{Sufficient Experience?}
            H -->|Yes| I[Prepare for Medical School]
            I --> J[Prerequisite Courses]
            J --> K[Study for MCAT]
            K --> L{MCAT Score Satisfactory?}
            L -->|Yes| N[Apply to Schools]
            L -->|No| M[Retake MCAT]
            N --> O{Accepted?}
            O -->|Yes| Q[Begin Medical School]
            O -->|No| P[Improve Application]
            Q --> R[Complete Pre-Clinical Years]
            R --> S[Clinical Rotations]
            S --> T{Choose Specialty?}
            T -->|Neurology| U[Focus on Neurology]
            T -->|Other| V[Explore Other Specialties]
            U --> W[Complete Residency]
            V --> W
            W --> X[Obtain License]
            X --> Y[Start Practice]
            Y --> Z{Continuous Learning}
            Z --> AA[Attend Conferences]
            Z --> AB[Pursue Research]
            Z --> AC[Mentor Students]
            AA --> Z
            AB --> Z
            AC --> Z
            Z --> AD[Impact Patients' Lives]
            AD --> AE{Career Satisfaction?}
            AE -->|Yes| AF[Continue Path]
            AE -->|No| AG[Reassess Goals]
        `;

        mermaid.mermaidAPI.render('mermaid-diagram', diagramDefinition, (svgCode) => {
            diagram.innerHTML = svgCode;
            const svgElement = diagram.querySelector('svg');
            svgElement.style.width = '100%';
            svgElement.style.height = '100%';
            
            // Fit diagram to optimal view
            fitDiagramToOptimalView();
        });

        function fitDiagramToOptimalView() {
            const svgElement = diagram.querySelector('svg');
            if (svgElement) {
                const containerWidth = diagramContainer.clientWidth;
                const containerHeight = diagramContainer.clientHeight;
                const diagramWidth = svgElement.getBoundingClientRect().width;
                const diagramHeight = svgElement.getBoundingClientRect().height;

                // Calculate scale to fit width with some padding
                const widthScale = (containerWidth * 0.9) / diagramWidth;
                
                // Calculate scale to fit height with some padding
                const heightScale = (containerHeight * 0.9) / diagramHeight;

                // Use the smaller scale to ensure the entire diagram fits
                scale = Math.min(widthScale, heightScale);

                // Further reduce the scale to zoom out a bit more
                scale *= 0.8;

                // Center the diagram
                diagramX = (containerWidth - diagramWidth * scale) / 2;
                diagramY = (containerHeight - diagramHeight * scale) / 2;

                updateTransform();
            }
        }

        function handleWheel(e) {
            e.preventDefault();
            const delta = e.deltaY * -0.0035;
            const newScale = Math.max(0.1, scale + delta); // Remove the upper limit

            
            // Adjust position to zoom towards cursor
            const rect = diagramContainer.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            diagramX = x - (x - diagramX) * newScale / scale;
            diagramY = y - (y - diagramY) * newScale / scale;
            
            scale = newScale;
            updateTransform();
        }

        function handleMouseDown(e) {
            isDragging = true;
            startX = e.clientX - diagramX;
            startY = e.clientY - diagramY;
        }

        function handleMouseMove(e) {
            if (!isDragging) return;
            diagramX = (e.clientX - startX);
            diagramY = (e.clientY - startY);
            updateTransform();
        }

        function handleMouseUp() {
            isDragging = false;
        }

        function updateTransform() {
            diagram.style.transform = `translate(${diagramX}px, ${diagramY}px) scale(${scale})`;
        }

        diagramContainer.addEventListener('wheel', handleWheel);
        diagramContainer.addEventListener('mousedown', handleMouseDown);
        diagramContainer.addEventListener('mousemove', handleMouseMove);
        diagramContainer.addEventListener('mouseup', handleMouseUp);
        diagramContainer.addEventListener('mouseleave', handleMouseUp);

        // Refit diagram on window resize
        window.addEventListener('resize', fitDiagramToOptimalView);
    </script>
</body>
</html>
